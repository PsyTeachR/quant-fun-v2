<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Data Wrangling 3 | Fundamentals of Quantitative Analysis</title>
<meta name="author" content="Emily Nordmann &amp; Phil McAleer">
<meta name="description" content="In the last chapter, we looked at using one-table Wickham verbs to filter, arrange, group_by, select, mutate and summarise the pong data. We also learnt a little more about pipes and we saw how to...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="Chapter 6 Data Wrangling 3 | Fundamentals of Quantitative Analysis">
<meta property="og:type" content="book">
<meta property="og:url" content="https://psyteachr.github.io/quant-fun-v2/data-wrangling-3.html">
<meta property="og:image" content="https://psyteachr.github.io/quant-fun-v2/images/logos/logo.png">
<meta property="og:description" content="In the last chapter, we looked at using one-table Wickham verbs to filter, arrange, group_by, select, mutate and summarise the pong data. We also learnt a little more about pipes and we saw how to...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Data Wrangling 3 | Fundamentals of Quantitative Analysis">
<meta name="twitter:description" content="In the last chapter, we looked at using one-table Wickham verbs to filter, arrange, group_by, select, mutate and summarise the pong data. We also learnt a little more about pipes and we saw how to...">
<meta name="twitter:image" content="https://psyteachr.github.io/quant-fun-v2/images/logos/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6NP3MF25W3');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentals of Quantitative Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="foreword.html">Foreword</a></li>
<li><a class="" href="programming-basics.html"><span class="header-section-number">1</span> Programming basics</a></li>
<li><a class="" href="intro-to-r.html"><span class="header-section-number">2</span> Intro to R</a></li>
<li><a class="" href="starting-with-data.html"><span class="header-section-number">3</span> Starting with data</a></li>
<li><a class="" href="data-wrangling-1.html"><span class="header-section-number">4</span> Data wrangling 1</a></li>
<li><a class="" href="data-wrangling-2.html"><span class="header-section-number">5</span> Data wrangling 2</a></li>
<li><a class="active" href="data-wrangling-3.html"><span class="header-section-number">6</span> Data Wrangling 3</a></li>
<li><a class="" href="intro-to-data-visualisation.html"><span class="header-section-number">7</span> Intro to Data Visualisation</a></li>
<li><a class="" href="probability.html"><span class="header-section-number">8</span> Probability</a></li>
<li><a class="" href="correlations.html"><span class="header-section-number">9</span> Correlations</a></li>
<li><a class="" href="t-tests.html"><span class="header-section-number">10</span> t-tests</a></li>
<li><a class="" href="power-and-error.html"><span class="header-section-number">11</span> Power and error</a></li>
<li><a class="" href="screening-data.html"><span class="header-section-number">12</span> Screening Data</a></li>
<li><a class="" href="visualisation.html"><span class="header-section-number">13</span> Visualisation</a></li>
<li><a class="" href="one-way-anova.html"><span class="header-section-number">14</span> One-way ANOVA</a></li>
<li><a class="" href="factorial-anova.html"><span class="header-section-number">15</span> Factorial ANOVA</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">16</span> Regression</a></li>
<li><a class="" href="multiple-regression.html"><span class="header-section-number">17</span> Multiple regression</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="installing-r.html"><span class="header-section-number">A</span> Installing R</a></li>
<li><a class="" href="updating-packages.html"><span class="header-section-number">B</span> Updating packages</a></li>
<li><a class="" href="additional-resources.html"><span class="header-section-number">C</span> Additional Resources</a></li>
<li><a class="" href="citing-r-rstudio.html"><span class="header-section-number">D</span> Citing R and RStudio</a></li>
<li><a class="" href="symbols.html"><span class="header-section-number">E</span> Symbols</a></li>
<li><a class="" href="conventions.html"><span class="header-section-number">F</span> Conventions</a></li>
<li><a class="" href="license.html">License</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/PsyTeachR/quant-fun-v2">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="data-wrangling-3" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Data Wrangling 3<a class="anchor" aria-label="anchor" href="#data-wrangling-3"><i class="fas fa-link"></i></a>
</h1>
<p>In the last chapter, we looked at using one-table Wickham verbs to <code>filter</code>, <code>arrange</code>, <code>group_by</code>, <code>select</code>, <code>mutate</code> and <code>summarise</code> the pong data. We also learnt a little more about <a class="glossary" target="_blank" title="" href="https://psyteachr.github.io/glossary/p#pipe">pipes</a> and we saw how to do some quick counting and some ungrouping. Be sure to try out those activities before moving on as we will start to add a few more functions to allow us a few more skills in <a class="glossary" target="_blank" title="The process of preparing data for visualisation and statistical analysis." href="https://psyteachr.github.io/glossary/d#data-wrangling">data wrangling</a>.</p>
<p>Today, as a progression from working with one table/tibble, we will focus on working with data across two or more tibbles To do this we are going to add two more functions, to the skills we already know. Those are:</p>
<ul>
<li>
<code>pivot_longer()</code> which allows us to <strong>transform</strong> a <a class="glossary" target="_blank" title="A container for tabular data with some different properties to a data frame" href="https://psyteachr.github.io/glossary/t#tibble">tibble</a> from <a class="glossary" target="_blank" title="Data where all of the observations about one subject are in the same row" href="https://psyteachr.github.io/glossary/w#wide">wide</a> format to <a class="glossary" target="_blank" title="Data where each observation is on a separate row" href="https://psyteachr.github.io/glossary/l#long">long</a> format.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join()</a></code> which allows us to <strong>combine</strong> two tibbles together based on common columns. We actually saw this <a class="glossary" target="_blank" title="A named section of code that can be reused." href="https://psyteachr.github.io/glossary/f#function">function</a> in Chapter 3 so this might be more of a recap.</li>
</ul>
<p>And just to recap, if you are still struggling with the idea of a function, remember that a function takes an input, performs some action, and gives an output. Think of your toaster again like we mentioned before: it takes bread as an input; it performs the action of heating it up; and it gives an output, the toast. A good thing about a lot of the functions we use is that they are nicely named as verbs to describe what they do - <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> mutates (adds on a column); <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> arranges columns, <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> summarises, etc. But keep in mind that you don't have to know or memorise all the different functions; through practice and repetition you will quickly learn to remember which ones are which and what <a class="glossary" target="_blank" title="A group of R functions." href="https://psyteachr.github.io/glossary/p#package">package</a> they come from. Sort of like where to find your spoons in your kitchen - you don't look in the fridge, and then the washing machine, and then the drawer. Nope, you learnt, by repetition, to look in the drawer first time. It's the same with functions. Keep in mind that research methods is like a language in that the more you use it and work with it the more it makes sense. So with that, let's do some practicing!</p>
<div id="tidy-data" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Tidy data<a class="anchor" aria-label="anchor" href="#tidy-data"><i class="fas fa-link"></i></a>
</h2>
<p>But first a little more on data structure and organisation.For most of this book, we will use a type of data organisation known as <a class="glossary" target="_blank" title="A format for data that maps the meaning onto the structure." href="https://psyteachr.github.io/glossary/t#tidy-data">tidy data</a>. Any data in this format is easily processed through the <code>tidyverse</code> package. However, the data you work with will not always start formatted in the most efficient way possible. If that happens then our first step is to put it into <code>Tidy Data</code> format. There are two fundamental principles defining <code>Tidy Data</code>:</p>
<ol style="list-style-type: decimal">
<li>Each variable must have its own column.</li>
<li>Each observation must have its own row.</li>
</ol>
<p><a href="https://www.jstatsoft.org/article/view/v059i10/v59i10.pdf" target="_blank">Tidy Data (Wickham, 2014)</a> adds the following principle:</p>
<ul>
<li>Each type of observation unit forms a table.</li>
</ul>
<p>And <a href="https://r4ds.had.co.nz/tidy-data.html" target="_blank">Grolemund and Wickham (2017)</a> restate this third principle as:</p>
<ul>
<li>Each value must have its own cell (i.e. no grouping two variables together, e.g. time/date in one cell).</li>
</ul>
<p>Where a cell is where any specific row and column meet; a single data point in a tibble is a cell for example. The <a href="https://r4ds.had.co.nz/tidy-data.html" target="_blank">Grolemund and Wickham (2017)</a> book is a very useful read and it is free, but browsing the chapter on Tidy Data will help you visualise how you want to arrange data. Try to keep the principles in mind whilst doing so.</p>
<div class="info">
<p>
If you've worked with any kind of data before, particularly if you've used Excel, it's very likely that you will have used <strong>wide format</strong> or <strong>long format</strong> data. In wide format, each participant's data is all in one row with multiple columns for different data points. This means that the data set tends to be very wide and you will have as many rows as you have participants.
</p>
<p>
Long format is where each <strong>row</strong> is a single observation, typically a single trial in an experiment or a response to a single item on a questionnaire. When you have multiple trials per participant, you will have multiple rows for the same participant. To identify participants, you would need a variable with some kind of participant id, which can be as simple as a distinct integer value for each participant. In addition to the participant identifier, you would have any measurements taken during each observation (e.g., response time) and what experimental condition the observation was taken under.
</p>
<p>
In wide format data, each <strong>row</strong> corresponds to a single participant, with multiple observations for that participant spread across columns. So for instance, with survey data, you would have a separate column for each survey question.
</p>
<p>
<code>Tidy</code> is a mix of both of these approachs and most functions in the tidyverse assume the tidy format, so typically the first thing you need to do when you get data, particularly wide-format data, is to reshape it through wrangling. Which is why we teach these really important skills.
</p>
<p>
There is more information about <a href="https://r4ds.had.co.nz/tidy-data.html">tidy data available here</a>.
</p>
</div>
</div>
<div id="analysing-the-autism-spectrum-quotient-aq" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Analysing the Autism Spectrum Quotient (AQ)<a class="anchor" aria-label="anchor" href="#analysing-the-autism-spectrum-quotient-aq"><i class="fas fa-link"></i></a>
</h2>
<p>To continue building your data wrangling skills in this chapter you will tidy data from the Autism Spectrum Quotient (AQ) questionnaire. The AQ10 is a non-diagnostic short form of the AQ with only 10 questions per participant. It is a discrete scale and the higher a participant scores on the AQ10 the more autistic-like traits they are said to display. Any person scoring 6 or above is recommended for further diagnosis. You can see an example of the AQ10 through this link: <a href="http://docs.autismresearchcentre.com/tests/AQ10.pdf">AQ10 Example</a>.</p>
<p><strong>Today's Goal</strong></p>
<p>Today we will be working with data from 66 participants and your goal in this chapter is to find an AQ score for each of them through your data-wrangling skills.</p>
<p>There are four data files to work with that you should download into your chapter folder. You can either right click and save each file separately below, or <a href="data/chpt6/PsyTeachR_FQA_Chpt6-data.zip" target="_blank">click here to download all the files in a zip file</a> for you to unzip:</p>
<ul>
<li>
<a href="responses.csv" download>responses.csv</a> containing the AQ survey responses to each of the 10 questions for the 66 participants</li>
<li>
<a href="qformats.csv" download>qformats.csv</a> containing information on how a question should be coded - i.e. forward or reverse coding</li>
<li>
<a href="scoring.csv" download>scoring.csv</a> containing information on how many points a specific response should get; depending on whether it is forward or reverse coded</li>
<li>
<a href="pinfo.csv" download>pinfo.csv</a> containing participant information such as Age, Sex and importantly <code>ID</code> number.</li>
</ul>
<p><br></p>
<div class="info">
<p>
<strong>Why do we use .csv</strong>
</p>
<p>
<code>csv</code> stands for 'comma separated variable', and is a very basic way of storing and transferring data. It really just stores numbers and text and nothing else. The great thing about being this basic is that it can be read by many different machines and does not need expensive licenses to open it.
</p>
</div>
<p>And now over a series of eight activities we will build on our data wrangling skills. Remember to try things out,and to ask questions, but that the solutions are at the bottom of the chapter if you are stuck.</p>
</div>
<div id="getting-set-up" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Getting Set-Up<a class="anchor" aria-label="anchor" href="#getting-set-up"><i class="fas fa-link"></i></a>
</h2>
<p>This first activity is about getting ourselves ready to analyse the data so try out the steps and if you need help, consult the earlier chapters.</p>
<div id="dw3-a1" class="section level3" number="6.3.1">
<h3>
<span class="header-section-number">6.3.1</span> Activity 1: Set-up Data Wrangling 3<a class="anchor" aria-label="anchor" href="#dw3-a1"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Open RStudio and set the working directory to your chapter folder. Ensure the environment is clear.
<ul>
<li>If you're using the Rserver, avoid a number of issues by restarting the session - click <code>Session</code> - <code>Restart R</code>
</li>
</ul>
</li>
<li>Open a new R Markdown document and save it in your working directory. Call the file "DataWrangling3".<br>
</li>
<li>Make sure that you have downloaded the four .csv files above and saved them in your chapter folder. Remember not to change the file names at all and that <code>data.csv</code> is not the same as <code>data (1).csv</code>.</li>
<li>Delete the default R Markdown welcome text and insert a new code chunk that loads the package <code>tidyverse</code> using the <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> function. Remember the solutions if needed.</li>
</ul>
</div>
</div>
<div id="loading-in-data" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Loading in Data<a class="anchor" aria-label="anchor" href="#loading-in-data"><i class="fas fa-link"></i></a>
</h2>
<p>Now you need to load in the <code>.csv</code> data files using the <code>read_csv()</code> function and save them as tibbles in the environment. For example, to load in the <code>responses.csv</code> file and save it as the object <code>responses</code>, we would type:</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">responses</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"responses.csv"</span><span class="op">)</span> </code></pre></div>
<div id="dw3-a2" class="section level3" number="6.4.1">
<h3>
<span class="header-section-number">6.4.1</span> Activity 2: Load in the data<a class="anchor" aria-label="anchor" href="#dw3-a2"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Add the following lines of code to your RMarkdown in a new code chunk and complete them to load in all four <code>.csv</code> data files. Use the above code as an example and name each object the same as its original file name (minus the .csv part), again as above, e.g. <code>responses.csv</code> gets saved as <code>responses</code>. Remember to run the lines so that the data loaded in and is stored in your environment.</li>
</ul>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="data-wrangling-3.html#cb100-1" aria-hidden="true" tabindex="-1"></a>responses <span class="ot">&lt;-</span>  <span class="fu">read_csv</span>()    <span class="co"># load in survey responses</span></span>
<span id="cb100-2"><a href="data-wrangling-3.html#cb100-2" aria-hidden="true" tabindex="-1"></a>qformats <span class="ot">&lt;-</span>                 <span class="co"># load in question formats</span></span>
<span id="cb100-3"><a href="data-wrangling-3.html#cb100-3" aria-hidden="true" tabindex="-1"></a>scoring <span class="ot">&lt;-</span>                  <span class="co"># load in scoring info</span></span>
<span id="cb100-4"><a href="data-wrangling-3.html#cb100-4" aria-hidden="true" tabindex="-1"></a>pinfo <span class="ot">&lt;-</span>                    <span class="co"># load in participant information</span></span></code></pre></div>
</div>
</div>
<div id="looking-at-data-1" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Looking at Data<a class="anchor" aria-label="anchor" href="#looking-at-data-1"><i class="fas fa-link"></i></a>
</h2>
<p>Now that we have the data loaded in it is always best to have a look at it to get an idea of its layout. We showed you a number ways of doing this before such as the <code><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse()</a></code> or <code><a href="https://rdrr.io/r/utils/View.html">View()</a></code> functions. Remember you put these in your Console window and put the name of the data between the brackets to see how it is arranged. Don't add these to your Markdown file, these are just for trying things out in the Console window</p>
<div id="dw3-a3" class="section level3" number="6.5.1">
<h3>
<span class="header-section-number">6.5.1</span> Activity 3: Look at your data<a class="anchor" aria-label="anchor" href="#dw3-a3"><i class="fas fa-link"></i></a>
</h3>
<p>Have a look at the data in <code>responses</code> to see if you think it is Tidy or not and answer the following question:</p>
<ul>
<li>The data in <code>responses</code> is in what format?
<div id="radio_UVRMXWWKHQ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_UVRMXWWKHQ" value=""><span>Tidy</span></label><label><input type="radio" autocomplete="off" name="radio_UVRMXWWKHQ" value=""><span>Long</span></label><label><input type="radio" autocomplete="off" name="radio_UVRMXWWKHQ" value="answer"><span>Wide</span></label>
</div>
</li>
</ul>
<div class="webex-solution">
<button>
Explain this answer
</button>
<p>The <code>reponses</code> tibble is far from being tidy; each row represents multiple observations from the same participant, i.e. each row shows responses to multiple questions and there are the same number of rows as there are participants (66)- <code>wide format</code>. Remember we want the data in tidy format as described above.</p>
<p>Eh, remind what's a tibble?</p>
<p>Remember, a tibble is simply a dataframe - or a table of data with columns and rows - that is really handy for working with when using the <code>tidyverse</code> package. When we say tibble, you can think of a dataframe with rows and columns of information and numbers stored in them - like <code>responses</code>, it is a tibble. For more info, see here: <a href="https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html" target="_blank">Tibbles</a>.</p>
</div>
</div>
</div>
<div id="gathering-your-data" class="section level2" number="6.6">
<h2>
<span class="header-section-number">6.6</span> Gathering Your Data<a class="anchor" aria-label="anchor" href="#gathering-your-data"><i class="fas fa-link"></i></a>
</h2>
<p>We now have all the data we need loaded in, but in order to make it easier for us to get the AQ score for each participant, we need to change the layout of the <code>responses</code> tibble to Tidy Data.</p>
<div id="dw3-a4" class="section level3" number="6.6.1">
<h3>
<span class="header-section-number">6.6.1</span> Activity 4: Gathering with pivot_longer()<a class="anchor" aria-label="anchor" href="#dw3-a4"><i class="fas fa-link"></i></a>
</h3>
<p>The first step is to use the function <code>pivot_longer()</code> to transform the data. The pivot functions can be easier to show than tell - you may find it a useful exercise to run the below code and compare the tibble in the newly created object <code>rlong</code> with the tibble in the original object, <code>respones</code>, before reading on.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rlong</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span>data <span class="op">=</span> <span class="va">responses</span>,
                      cols <span class="op">=</span> <span class="va">Q1</span><span class="op">:</span><span class="va">Q10</span>,
                      names_to <span class="op">=</span> <span class="st">"Question"</span>, 
                      values_to <span class="op">=</span> <span class="st">"Response"</span><span class="op">)</span></code></pre></div>
<p>To break this code down a little to help you understand it more:</p>
<ul>
<li>As with the other tidyverse functions, the first argument specifies the dataset to use as the base, in this case <code>responses</code>.
<ul>
<li>And remember the more experienced and confident you get you do not have to write the argument names, e.g. <code>data =</code>.</li>
</ul>
</li>
<li>The second argument, <code>cols</code> specifies all the columns you want to transform. The easiest way to visualise this is to think about which columns would be the same in the new long-form dataset and which will change. In this case, we only have a single column <code>Id</code> that will remain constant and we will transform all the the other columns that contain participant's responses to each question.
<ul>
<li>The colon notation <code>first_column:last_column</code> is used to select all variables from the first column specified to the second column specified. So in our code, <code>cols</code> specifies that the columns we want to transform are <code>Q1</code> to <code>Q10</code>.</li>
<li>Note that "Gathering" of columns is based on position in the tibble. If the order of columns in the tibble was Q1 then Q10, the above code would only gather those two columns. As it is, in our tibble, the order, is Q1, Q2, Q3, ... Q10, and therefore the code gathers all the columns between Q1 and Q10.</li>
</ul>
</li>
<li>The third and fourth arguments are the names of the new columns we are creating.
<ul>
<li>
<code>names_to</code> specifies the names of the new columns that will be created.</li>
<li>Finally, <code>values_to</code> names the new column that will contain the measurements, in this case we'll call it <code>Response</code>.</li>
<li>These new column names are put in quotes because they do not already exist in the tibble. This is not always the case but is the case for this function.</li>
<li>Note also that these names could have been anything but by using these names the code makes more sense.</li>
<li>Lastly, you do need to write names_to = ... and values_to = ... otherwise the columns won't be created correctly.</li>
</ul>
</li>
</ul>
<p>And now that we have run the code and explained it a bit, you may find it helpful to go back and compare <code>rlong</code> and <code>responses</code> again to see how each argument matches up with the output of the table.</p>
</div>
</div>
<div id="joining-your-data" class="section level2" number="6.7">
<h2>
<span class="header-section-number">6.7</span> Joining Your Data<a class="anchor" aria-label="anchor" href="#joining-your-data"><i class="fas fa-link"></i></a>
</h2>
<p>Now the <code>responses</code> data is in tidy format, you are closer to being able to calculate an AQ score for each person. However, you still need some extra information:</p>
<ul>
<li>Were the questions reverse or forward scored (i.e., is strongly agree a positive or negative response)? This information is found in <code>qformats</code>
</li>
<li>How many points are given to a specific response? This information is found in <code>scoring</code>.</li>
</ul>
<p>This is a typical analysis situation where different information is in different tables and you need to join them altogether. Both these pieces of information are contained in <code>qformats</code> and <code>scoring</code> respectively, but we want to join them to <code>responses</code> to create one informative tidy table with all the information we need. We can do this type of join through the function <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join()</a></code>; a function to combine information in two tibbles using a column common to both tibbles.</p>
<div id="dw3-a5" class="section level3" number="6.7.1">
<h3>
<span class="header-section-number">6.7.1</span> Activity 5: Combining data<a class="anchor" aria-label="anchor" href="#dw3-a5"><i class="fas fa-link"></i></a>
</h3>
<p>A wee bit different of an approach here in this activity but try it out and see how you get on. Remember that the solutions are at the end of the chapter.</p>
<ul>
<li>Copy the code below into a new code chunk.</li>
<li>Next, replace the <code>NULL</code> values in the below code with the necessary variable names to join <code>rlong</code> and <code>qformats</code> by <code>Question</code>. If you need extra help, revisit Starting with Data chapter as you used the same function then! Make sure you try yourself first.
<ul>
<li>
<strong>Hint:</strong> join two tibbles (x and y) by "a common column".</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rlong2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, 
                     y <span class="op">=</span> <span class="cn">NULL</span>, 
                     by <span class="op">=</span> <span class="st">"NULL"</span><span class="op">)</span></code></pre></div>
<ul>
<li>Now have a look at the tibble in <code>rlong2</code>. As you can see we have matched each question with its scoring format, <code>forward</code> or <code>reverse</code>.</li>
</ul>
<div class="info">
<p>
<strong>What is forward and reverse scoring</strong>
</p>
<p>
A lot of questionnaires have some questions that are Forward scored and some questions that are Reverse scored. What does this mean? Imagine a situation where your options in replying to a question are: 1 - extremely agree, 2 - agree, 3 - neutral, 4 - disagree, 5 - extremely disagree. In a forward-scoring question you would get 1 point for extremely agree, 2 for agree, 3 for neutral, etc. In a reverse scoring question you would get 5 for extremely agree, 4 for agree, 3 for neutral, etc.
</p>
<p>
The reasoning behind this shift is that sometimes agreeing or disagreeing might be more favorable depending on how the question is worded. Secondly, sometimes these questions are used just to catch people out - imagine if you had two similar questions where one has the reverse meaning of the other. In this scenario, people should respond opposites. If they respond the same then they might not be paying attention.
</p>
</div>
<p>So far so good but there is more information we want to bring into the tibble. We now need to combine the information in our new tibble, <code>rlong2</code>, with the <code>scoring</code> tibble so you know how many points to attribute each question based on the answer the participant gave, and whether the question was forward or reverse coded. Again, you can use the <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join()</a></code> function, but this time the common columns found in <code>rlong2</code> and <code>scoring</code> are <code>QFormat</code> and <code>Response</code> - i.e. there are two common columns.</p>
</div>
<div id="dw3-a6" class="section level3" number="6.7.2">
<h3>
<span class="header-section-number">6.7.2</span> Activity 6: Combining more data<a class="anchor" aria-label="anchor" href="#dw3-a6"><i class="fas fa-link"></i></a>
</h3>
<p>Here, in the code below, we are going to show you how to combine data with two common columns. Really this is about combining tibbles were there is corresponding information in the two tibbles - participants appear in both tibbles but there is different info in each tibble and you want it all in the one tibble. This is called an <a class="glossary" target="_blank" title="A mutating join that returns all the rows that have a match in the other table." href="https://psyteachr.github.io/glossary/i#inner-join">inner-join</a> But first some information on this task.</p>
<ul>
<li>You can only ever join two tables with <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join()</a></code> at once. If you have multiple tibbles to join like we do, you need to do multiple calls to <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join()</a></code>.</li>
<li>When there is more than one common column between two tibbles you are joining, it is best to combine by all the columns to avoid repeated columns names in the new tibble. For example, if you run a join and it produces columns named <code>variable.x</code> and <code>variable.y</code> it means that there was another column that was the same in both datasets that you didn't add to <code>by =</code>.</li>
<li>You have to be very careful to use <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> if you have multiple variables for <code>by</code>. This is a common error and results in the <code>variable.x</code>/<code>variable.y</code> issue above. If you forget to use the <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> and just state different columns, the code will only look at the first column and ignore the rest.</li>
</ul>
<p>Now type the below line into a new code chunk in your RMarkdown file, run it, and then view the new object. What this code does is it combines <code>rlong2</code> and <code>scoring</code> based on the matching data in <code>QFormat</code> and <code>Response</code></p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rscores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">rlong2</span>, 
                      <span class="va">scoring</span>, 
                      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"QFormat"</span>, <span class="st">"Response"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>You have now created <code>rscores</code> which has information on how each participant responded to each question and how each question should be coded and scored, all within the one tibble. All you need now is to sum the scores for each participant to get their AQ score.</p>
</div>
<div id="dw3-a7" class="section level3" number="6.7.3">
<h3>
<span class="header-section-number">6.7.3</span> Activity 7: Calculating the AQ scores<a class="anchor" aria-label="anchor" href="#dw3-a7"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>First, based on your knowledge from the last chapter, type the below line into your code and replace the NULLs to obtain individual <code>aq_scores</code> for each participant.
<ul>
<li>
<strong>hint:</strong> <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> - how will you group individual participants?</li>
<li>
<strong>hint:</strong> <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> - which column will you sum to obtain AQ scores?</li>
</ul>
</li>
<li>Then, save your Markdown and knit it to make sure all your code works.</li>
</ul>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aq_scores</span> <span class="op">&lt;-</span> <span class="va">rscores</span> <span class="op">%&gt;%</span> 
             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">%&gt;%</span>
             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>AQ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="webex-solution">
<button>
Additional Hints
</button>
<p>Each participant could be grouped by their Id.</p>
<p>If we summed up the value for each Score we might get a full AQ Score for each particpipant.</p>
</div>
<p>Excellent. Have a look at <code>aq_scores</code> and see that you have all the individual AQ scores for each participant!</p>
</div>
</div>
<div id="pipes-again" class="section level2" number="6.8">
<h2>
<span class="header-section-number">6.8</span> Pipes Again!<a class="anchor" aria-label="anchor" href="#pipes-again"><i class="fas fa-link"></i></a>
</h2>
<p>You now have a complete code to load in your data, convert it to Tidy, combine the tables and calculate an AQ score for each participant. But, if you look at it, some of your code could be more efficient by using pipes. Let's see how well we understand pipes now!</p>
<div id="dw3-a8" class="section level3" number="6.8.1">
<h3>
<span class="header-section-number">6.8.1</span> Activity 8: One last thing on pipes<a class="anchor" aria-label="anchor" href="#dw3-a8"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Go back through your code and try to rewrite it using pipes <code><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></code> so that it is as efficient as possible.
<ul>
<li>
<strong>hint:</strong> At any point where the first argument of your function is the name of an object created before that line, there is a good chance you could have used a pipe!</li>
</ul>
</li>
</ul>
<div class="webex-solution">
<button>
Additional Hints
</button>
<p>Here are all the bits of this code that could be piped together into one chain:</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">`rlong &lt;- pivot_longer(responses, names_to = "Question", values_to = "Response", Q1:Q10)`</span>

<span class="va">`rlong2 &lt;- inner_join(rlong, qformats, \"Question\")`</span>

<span class="va">`rscores &lt;- inner_join(rlong2, scoring, c(\"QFormat\", \"Response\"))`</span>

<span class="va">`aq_scores &lt;- rscores %&gt;% group_by(Id) %&gt;% summarise(AQ = sum(Score))`</span></code></pre></div>
</div>
</div>
</div>
<div id="finished-1" class="section level2" number="6.9">
<h2>
<span class="header-section-number">6.9</span> Finished<a class="anchor" aria-label="anchor" href="#finished-1"><i class="fas fa-link"></i></a>
</h2>
<p>Brilliant work again today! You have now recapped one-table verbs and started to expand your knowledge of two-table verbs. These are great to know as for example, as seen above, it actually only took a handful of reproducible steps to get from messy data to tidy data; could you imagine doing this by hand in Excel through cutting and pasting? Not to mention the mistakes you could make! Excellent work! You are a DataWrangling expert! Before finishing, remember to go over anything you are unsure of, and if you have any questions, please post them on Teams. There are some additional questions below to help you check your understanding.</p>
</div>
<div id="dw3-test" class="section level2" number="6.10">
<h2>
<span class="header-section-number">6.10</span> Test yourself<a class="anchor" aria-label="anchor" href="#dw3-test"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>
<p>Complete the sentence, the higher the AQ score...</p>
<div id="radio_KCNYEPGCVS" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_KCNYEPGCVS" value=""><span>the less autistic-like traits displayed</span></label><label><input type="radio" autocomplete="off" name="radio_KCNYEPGCVS" value=""><span>has no relation to autistic-like traits</span></label><label><input type="radio" autocomplete="off" name="radio_KCNYEPGCVS" value="answer"><span>the more autistic-like traits displayed</span></label>
</div>
</li>
<li>
<p>Assuming that your code all worked, what was the AQ score (just the number) of Participant ID No. 87:</p>
<div id="radio_CVAITDPSET" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_CVAITDPSET" value="answer"><span>2</span></label><label><input type="radio" autocomplete="off" name="radio_CVAITDPSET" value=""><span>3</span></label><label><input type="radio" autocomplete="off" name="radio_CVAITDPSET" value=""><span>5</span></label><label><input type="radio" autocomplete="off" name="radio_CVAITDPSET" value=""><span>6</span></label>
</div>
</li>
<li><p>Type in the box how many participants had an AQ score of 3 (again just the number): <input class="webex-solveme nospaces" size="10" data-answer='["13"]'></p></li>
<li>
<p>The cut-off for the AQ10 is usually said to be around 6 meaning that anyone with a score of more than 6 should be referred for diagnostic assessment. Based on this data, how many participants might be referred for further assessment?</p>
<div id="radio_WINDNKYNDS" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_WINDNKYNDS" value=""><span>2</span></label><label><input type="radio" autocomplete="off" name="radio_WINDNKYNDS" value=""><span>4</span></label><label><input type="radio" autocomplete="off" name="radio_WINDNKYNDS" value="answer"><span>6</span></label><label><input type="radio" autocomplete="off" name="radio_WINDNKYNDS" value=""><span>8</span></label>
</div>
</li>
</ul>
<div class="webex-solution">
<button>
Explain these answers
</button>
<ol style="list-style-type: decimal">
<li><p>As mentioned, the higher the score on the AQ10 the more autistic-like traits a participant is said to show.</p></li>
<li><p>You could do this by code with <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter(aq_scores, Id == 87)</a></code>, which would give you a tibble of 1x2 showing the ID number and score. If you just wanted the score you could use <code><a href="https://dplyr.tidyverse.org/reference/pull.html">pull()</a></code> but we haven't shown you that yet: <code>filter(aq_scores, Id == 87) %&gt;% pull(AQ)</code>. The answer is an AQ score of 2.</p></li>
<li><p>Same as above but changing the argument of the filter. <code>filter(aq_scores, AQ == 3) %&gt;% count()</code>. The answer is 13. Remember you can do this by counting but the code makes it reproducible and accurate every time. You might make mistakes.</p></li>
<li><p><code>filter(aq_scores, AQ &gt; 6) %&gt;% count()</code> or <code>filter(aq_scores, AQ &gt;= 7) %&gt;% count()</code>. The answer is 6.</p></li>
</ol>
</div>
<p><strong>Recap on Wickham Verbs!</strong></p>
<p>Which function(s) would you use to approach each of the following problems?</p>
<ul>
<li><p>We have a dataset of 400 adults, but we want to remove anyone with an age of 50 years or more. To do this, we could use the <select class="webex-select"><option value="blank"></option>
<option value="">group_by()</option>
<option value="">arrange()</option>
<option value="answer">filter()</option>
<option value="">summarise()</option>
<option value="">mutate()</option>
<option value="">select()</option></select> function.</p></li>
<li><p>We are interested in overall summary statistics for our data, such as the overall average and total number of observations. To do this, we could use the <select class="webex-select"><option value="blank"></option>
<option value="">group_by()</option>
<option value="answer">summarise()</option>
<option value="">mutate()</option>
<option value="">select()</option>
<option value="">arrange()</option>
<option value="">filter()</option></select> function.</p></li>
<li><p>Our dataset has a column with the number of cats a person has, and a column with the number of dogs. We want to calculate a new column which contains the total number of pets each participant has. To do this, we could use the <select class="webex-select"><option value="blank"></option>
<option value="">arrange()</option>
<option value="">summarise()</option>
<option value="">group_by()</option>
<option value="">filter()</option>
<option value="">select()</option>
<option value="answer">mutate()</option></select> function.</p></li>
<li><p>We want to calculate the average for each participant in our dataset. To do this we could use the <select class="webex-select"><option value="blank"></option>
<option value="answer">group_by() and summarise()</option>
<option value="">filter() and select()</option>
<option value="">group_by() and arrange()</option>
<option value="">arrange() and mutate()</option></select> functions.</p></li>
<li><p>We want to order a dataframe of participants by the number of cats that they own, but want our new dataframe to only contain some of our columns. To do this we could use the <select class="webex-select"><option value="blank"></option>
<option value="answer">arrange() and select()</option>
<option value="">select() and summarise()</option>
<option value="">group_by() and mutate()</option>
<option value="answer">filter() and select()</option></select> functions.</p></li>
</ul>
<div class="webex-solution">
<button>
Explain these Answers
</button>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> helps us keep and remove rows!</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> is the main function for creating means, medians, modes, etc.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> can be used to add columns to help add more information.</li>
<li>When you want summary statistics for individual groups or participants you have to first <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> and then <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code>.</li>
<li>You would need to <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> first to reduce the people based on their number of cats and then just <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> the columns you want to keep.</li>
</ul>
</div>
</div>
<div id="dw3-sols" class="section level2" number="6.11">
<h2>
<span class="header-section-number">6.11</span> Activity solutions<a class="anchor" aria-label="anchor" href="#dw3-sols"><i class="fas fa-link"></i></a>
</h2>
<p>Below you will find the solutions to the above questions. Only look at them after giving the questions a good try and trying to find help on Google or Teams about any issues.</p>
<div id="dw3-a1sol" class="section level3" number="6.11.1">
<h3>
<span class="header-section-number">6.11.1</span> Activity 1<a class="anchor" aria-label="anchor" href="#dw3-a1sol"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>To load the tidyverse into the library we would do the following:</li>
</ul>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="dw3-a2sol" class="section level3" number="6.11.2">
<h3>
<span class="header-section-number">6.11.2</span> Activity 2<a class="anchor" aria-label="anchor" href="#dw3-a2sol"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Remember that you should always use <code>read_csv()</code> when working with this book.</li>
<li>You read the data into the objects as follows.</li>
</ul>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">responses</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"responses.csv"</span><span class="op">)</span>                  
<span class="va">qformats</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"qformats.csv"</span><span class="op">)</span>                 
<span class="va">scoring</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"scoring.csv"</span><span class="op">)</span>                  
<span class="va">pinfo</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"pinfo.csv"</span><span class="op">)</span></code></pre></div>
</div>
<div id="dw3-a5sol" class="section level3" number="6.11.3">
<h3>
<span class="header-section-number">6.11.3</span> Activity 5<a class="anchor" aria-label="anchor" href="#dw3-a5sol"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>In this <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join()</a></code> the first tibble is in <code>rlong</code>, the second tibble is in <code>qformats</code> and the common column is <code>Question</code>.</li>
</ul>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rlong2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rlong</span>, 
                     y <span class="op">=</span> <span class="va">qformats</span>, 
                     by <span class="op">=</span> <span class="st">"Question"</span><span class="op">)</span></code></pre></div>
</div>
<div id="dw3-a7sol" class="section level3" number="6.11.4">
<h3>
<span class="header-section-number">6.11.4</span> Activity 7<a class="anchor" aria-label="anchor" href="#dw3-a7sol"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>To create the AQ score we would first group_by the <code>Id</code> column so that we have each individual participants data, and then we would sum the <code>Score</code> column to obtain their AQ score.</li>
</ul>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aq_scores</span> <span class="op">&lt;-</span> <span class="va">rscores</span> <span class="op">%&gt;%</span> 
             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Id</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># group by the ID number in column Id</span>
             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>AQ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Score</span><span class="op">)</span><span class="op">)</span> <span class="co"># sum column Score to obtain AQ scores.</span></code></pre></div>
</div>
<div id="dw3-a8sol" class="section level3" number="6.11.5">
<h3>
<span class="header-section-number">6.11.5</span> Activity 8<a class="anchor" aria-label="anchor" href="#dw3-a8sol"><i class="fas fa-link"></i></a>
</h3>
<p>This was a tricky one but here is how you might read out the below code. Remember that <code><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></code> can be read as <code>and then...</code></p>
<ul>
<li>First, take the data in <code>responses</code> and then</li>
<li>take columns Q1 to Q10, put the column names in Question and the scores in Response and then</li>
<li>join with <code>qformats</code> and match the data by the column <code>Question</code> and then</li>
<li>join with <code>scoring</code> and match the data by the columns <code>Qformat</code> and <code>Response</code> and then</li>
<li>group by participant ID and then</li>
<li>calculate the total AQ score</li>
</ul>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aq_scores2</span> <span class="op">&lt;-</span> <span class="va">responses</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">Q1</span><span class="op">:</span><span class="va">Q10</span>,
               names_to <span class="op">=</span> <span class="st">"Question"</span>, 
               values_to <span class="op">=</span> <span class="st">"Response"</span><span class="op">)</span> <span class="op">%&gt;%</span>  
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">qformats</span>, <span class="st">"Question"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">scoring</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"QFormat"</span>, <span class="st">"Response"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Id</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>AQ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Score</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
</div>
</div>
<div id="words-from-this-chapter-5" class="section level2" number="6.12">
<h2>
<span class="header-section-number">6.12</span> Words from this Chapter<a class="anchor" aria-label="anchor" href="#words-from-this-chapter-5"><i class="fas fa-link"></i></a>
</h2>
<p>Below you will find a list of words that were used in this chapter that might be new to you in case it helps to have somewhere to refer back to what they mean. The links in this table take you to the entry for the words in the <a href="https://psyteachr.github.io/glossary/" target="_blank">PsyTeachR Glossary</a>. Note that the Glossary is written by numerous members of the team and as such may use slightly different terminology from that shown in the chapter.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="58%">
<col width="41%">
</colgroup>
<thead><tr class="header">
<th align="left">term</th>
<th align="left">definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><a href="https://psyteachr.github.io/glossary/d.html#data-wrangling" class="glossary" target="_blank">data wrangling</a></td>
<td align="left">The process of preparing data for visualisation and statistical analysis.</td>
</tr>
<tr class="even">
<td align="left"><a href="https://psyteachr.github.io/glossary/f.html#function" class="glossary" target="_blank">function</a></td>
<td align="left">A named section of code that can be reused.</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://psyteachr.github.io/glossary/i.html#inner-join" class="glossary" target="_blank">inner join</a></td>
<td align="left">A mutating join that returns all the rows that have a match in the other table.</td>
</tr>
<tr class="even">
<td align="left"><a href="https://psyteachr.github.io/glossary/l.html#long" class="glossary" target="_blank">long</a></td>
<td align="left">Data where each observation is on a separate row</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://psyteachr.github.io/glossary/p.html#package" class="glossary" target="_blank">package</a></td>
<td align="left">A group of R functions.</td>
</tr>
<tr class="even">
<td align="left"><a href="https://psyteachr.github.io/glossary/p.html#pipe" class="glossary" target="_blank">pipe</a></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><a href="https://psyteachr.github.io/glossary/t.html#tibble" class="glossary" target="_blank">tibble</a></td>
<td align="left">A container for tabular data with some different properties to a data frame</td>
</tr>
<tr class="even">
<td align="left"><a href="https://psyteachr.github.io/glossary/t.html#tidy-data" class="glossary" target="_blank">tidy data</a></td>
<td align="left">A format for data that maps the meaning onto the structure.</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://psyteachr.github.io/glossary/w.html#wide" class="glossary" target="_blank">wide</a></td>
<td align="left">Data where all of the observations about one subject are in the same row</td>
</tr>
</tbody>
</table></div>
<p>That is end of this chapter. Be sure to look again at anything you were unsure about and make some notes to help develop your own knowledge and skills. It would be good to write yourself some questions about what you are unsure of and see if you can answer them later or speak to someone about them. Good work today!</p>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  var cite = ' ';
  var psyteachr = ' <a href="https://psyteachr.github.io/"><img src="images/logos/psyteachr_logo.png" style="height: 31px; color: white;" alt="psyTeachR: Reproducible Research" /></a>';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    psyteachr + license + cite
  );
  
  // open rdrr links externally
  $("a[href^='https://rdrr.io']").click(function(){
    window.open(this.href);
    return false;
  });
  
  // visible second sidebar in mobile
  function move_sidebar() {
    var w = window.innerWidth;
    if (w < 992) {
      $("#toc").appendTo($("#main-nav"));
    } else {
      $("#toc").appendTo($("div.sidebar-chapter"));
    }
  }
  move_sidebar();
  window.onresize = move_sidebar;
});
</script><div class="chapter-nav">
<div class="prev"><a href="data-wrangling-2.html"><span class="header-section-number">5</span> Data wrangling 2</a></div>
<div class="next"><a href="intro-to-data-visualisation.html"><span class="header-section-number">7</span> Intro to Data Visualisation</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#data-wrangling-3"><span class="header-section-number">6</span> Data Wrangling 3</a></li>
<li><a class="nav-link" href="#tidy-data"><span class="header-section-number">6.1</span> Tidy data</a></li>
<li><a class="nav-link" href="#analysing-the-autism-spectrum-quotient-aq"><span class="header-section-number">6.2</span> Analysing the Autism Spectrum Quotient (AQ)</a></li>
<li>
<a class="nav-link" href="#getting-set-up"><span class="header-section-number">6.3</span> Getting Set-Up</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#dw3-a1"><span class="header-section-number">6.3.1</span> Activity 1: Set-up Data Wrangling 3</a></li></ul>
</li>
<li>
<a class="nav-link" href="#loading-in-data"><span class="header-section-number">6.4</span> Loading in Data</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#dw3-a2"><span class="header-section-number">6.4.1</span> Activity 2: Load in the data</a></li></ul>
</li>
<li>
<a class="nav-link" href="#looking-at-data-1"><span class="header-section-number">6.5</span> Looking at Data</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#dw3-a3"><span class="header-section-number">6.5.1</span> Activity 3: Look at your data</a></li></ul>
</li>
<li>
<a class="nav-link" href="#gathering-your-data"><span class="header-section-number">6.6</span> Gathering Your Data</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#dw3-a4"><span class="header-section-number">6.6.1</span> Activity 4: Gathering with pivot_longer()</a></li></ul>
</li>
<li>
<a class="nav-link" href="#joining-your-data"><span class="header-section-number">6.7</span> Joining Your Data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#dw3-a5"><span class="header-section-number">6.7.1</span> Activity 5: Combining data</a></li>
<li><a class="nav-link" href="#dw3-a6"><span class="header-section-number">6.7.2</span> Activity 6: Combining more data</a></li>
<li><a class="nav-link" href="#dw3-a7"><span class="header-section-number">6.7.3</span> Activity 7: Calculating the AQ scores</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#pipes-again"><span class="header-section-number">6.8</span> Pipes Again!</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#dw3-a8"><span class="header-section-number">6.8.1</span> Activity 8: One last thing on pipes</a></li></ul>
</li>
<li><a class="nav-link" href="#finished-1"><span class="header-section-number">6.9</span> Finished</a></li>
<li><a class="nav-link" href="#dw3-test"><span class="header-section-number">6.10</span> Test yourself</a></li>
<li>
<a class="nav-link" href="#dw3-sols"><span class="header-section-number">6.11</span> Activity solutions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#dw3-a1sol"><span class="header-section-number">6.11.1</span> Activity 1</a></li>
<li><a class="nav-link" href="#dw3-a2sol"><span class="header-section-number">6.11.2</span> Activity 2</a></li>
<li><a class="nav-link" href="#dw3-a5sol"><span class="header-section-number">6.11.3</span> Activity 5</a></li>
<li><a class="nav-link" href="#dw3-a7sol"><span class="header-section-number">6.11.4</span> Activity 7</a></li>
<li><a class="nav-link" href="#dw3-a8sol"><span class="header-section-number">6.11.5</span> Activity 8</a></li>
</ul>
</li>
<li><a class="nav-link" href="#words-from-this-chapter-5"><span class="header-section-number">6.12</span> Words from this Chapter</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/PsyTeachR/quant-fun-v2/blob/master/book/06-wrangling-3.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/PsyTeachR/quant-fun-v2/edit/master/book/06-wrangling-3.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentals of Quantitative Analysis</strong>" was written by Emily Nordmann &amp; Phil McAleer. It was last built on 2021-10-23.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
